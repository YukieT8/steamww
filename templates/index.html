<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Steam Workshop Downloader</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding-top: 50px; background: #1b2838; color: white; }
        .card { background: #2a475e; padding: 20px; border-radius: 8px; width: 400px; }
        input, button { width: 100%; padding: 10px; margin: 10px 0; border-radius: 4px; border: none; }
        button { background: #66c0f4; color: white; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <div class="card">
        <h2>Workshop Downloader</h2>
        <input type="text" id="app_id" placeholder="App ID (например, 4000 для GMod)">
        <input type="text" id="url" placeholder="Ссылка на мод или коллекцию">
        <button onclick="startDownload()">Скачать в ZIP</button>
        <p id="status"></p>
    </div>

    <script>
        async function startDownload() {
            const status = document.getElementById('status');
            status.innerText = "Начинаем загрузку... Это может занять пару минут.";
            
            const response = await fetch('/download', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    url: document.getElementById('url').value,
                    app_id: document.getElementById('app_id').value
                })
            });

            if (response.ok) {
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = "workshop_mod.zip";
                document.body.appendChild(a);
                a.click();
                status.innerText = "Готово!";
            } else {
                status.innerText = "Ошибка загрузки.";
            }
        }
    </script>
</body>
</html>
